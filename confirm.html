<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</title>
  <script>
    async function submitConfirm(status) {
      const params = new URLSearchParams(window.location.search);
      const id = params.get("id");
      const url = `https://script.google.com/macros/s/AKfycbwOiSYN37QTLiFdz8F0VfVBHGGsoA7Rn6DoAQn0ZBa7Ss6E-UP6WDZVncDgnVby1cVOyQ/exec?method=updateConfirmData&id=${id}&confirmStatus=${encodeURIComponent(status)}`;

      try {
        const res = await fetch(url);   // ‚úÖ ‡∏™‡πà‡∏á GET ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Apps Script
        const text = await res.text();  // ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡πÄ‡∏ä‡πà‡∏ô "‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢"
        alert(text);

        // ‡∏õ‡∏¥‡∏î LIFF ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ LINE
        if (window.liff && liff.closeWindow) liff.closeWindow();
      } catch (err) {
        alert("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î");
        console.error(err);
      }
    }

    window.onload = () => {
      const params = new URLSearchParams(window.location.search);
      document.getElementById("activity").textContent = decodeURIComponent(params.get("activity") || "-");
      document.getElementById("bookerName").textContent = decodeURIComponent(params.get("bookerName") || "-");
      document.getElementById("datetime").textContent = `${decodeURIComponent(params.get("date") || "-")} ‡πÄ‡∏ß‡∏•‡∏≤ ${decodeURIComponent(params.get("time") || "-")}`;
    }
  </script>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 50px; }
    button {
      padding: 12px 24px;
      font-size: 18px;
      margin: 10px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    #yesBtn { background-color: #28a745; color: white; }
    #noBtn { background-color: #dc3545; color: white; }
  </style>
</head>
<body>
  <h2>üìå ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h2>
  <p>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°: <span id="activity"></span></p>
  <p>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á: <span id="bookerName"></span></p>
  <p>‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤: <span id="datetime"></span></p>

  <button id="yesBtn" onclick="submitConfirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß')">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
  <button id="noBtn" onclick="submitConfirm('‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å')">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
</body>
</html>
