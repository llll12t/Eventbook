<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</title>
<script>
  // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á init liff ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö web ‡∏õ‡∏Å‡∏ï‡∏¥
  window.onload = function () {
    const urlParams = new URLSearchParams(window.location.search);
    const id = urlParams.get('id');
    const activity = urlParams.get('activity');
    const bookerName = urlParams.get('bookerName');
    const date = urlParams.get('date');
    const time = urlParams.get('time');

    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤
    document.getElementById('activity').textContent = decodeURIComponent(activity || '-');
    document.getElementById('bookerName').textContent = decodeURIComponent(bookerName || '-');
    document.getElementById('datetime').textContent = `${decodeURIComponent(date || '-')} ‡πÄ‡∏ß‡∏•‡∏≤ ${decodeURIComponent(time || '-')}`;

    // ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô/‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
    document.getElementById("yesBtn").onclick = () => submitConfirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß");
    document.getElementById("noBtn").onclick = () => submitConfirm("‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å");

    async function submitConfirm(status) {
      const apiUrl = `https://script.google.com/macros/s/AKfycbwOiSYN37QTLiFdz8F0VfVBHGGsoA7Rn6DoAQn0ZBa7Ss6E-UP6WDZVncDgnVby1cVOyQ/exec?method=updateConfirmData&id=${id}&confirmStatus=${status}`;
      try {
        const res = await fetch(apiUrl);
        const text = await res.text();
        alert(text);
        // ‡∏õ‡∏¥‡∏î liff ‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
        if (window.liff && liff.closeWindow) liff.closeWindow();
      } catch (err) {
        alert("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ");
        console.error(err);
      }
    }
  }

  </script>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 50px; }
    button {
      padding: 12px 24px;
      font-size: 18px;
      margin: 10px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    #yesBtn { background-color: #28a745; color: white; }
    #noBtn { background-color: #dc3545; color: white; }
  </style>
</head>
<body>
  <h2>üìå ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h2>
  <p>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°: <span id="activity"></span></p>
  <p>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á: <span id="bookerName"></span></p>
  <p>‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤: <span id="datetime"></span></p>

  <button id="yesBtn" onclick="submitConfirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß')">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
  <button id="noBtn" onclick="submitConfirm('‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å')">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
</body>
</html>
