<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    async function main() {
      await liff.init({ liffId: '2007305761-QGOV3Zww' }); // üîÅ ‡πÉ‡∏™‡πà LIFF ID ‡∏à‡∏£‡∏¥‡∏á

      const urlParams = new URLSearchParams(window.location.search);
      const id = urlParams.get('id');
      const activity = urlParams.get('activity');
      const bookerName = urlParams.get('bookerName');
      const date = urlParams.get('date');
      const time = urlParams.get('time');

      // ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏á DOM
      document.getElementById('activity').innerText = activity || '-';
      document.getElementById('bookerName').innerText = bookerName || '-';
      document.getElementById('datetime').innerText = `${date || '-'} ‡πÄ‡∏ß‡∏•‡∏≤ ${time || '-'}`;

      // ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î‡∏™‡πà‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏•‡∏±‡∏ö
      document.getElementById("yesBtn").onclick = () => submitConfirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß");
      document.getElementById("noBtn").onclick = () => submitConfirm("‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å");

      async function submitConfirm(status) {
        const apiUrl = `https://script.google.com/macros/s/AKfycbwOiSYN37QTLiFdz8F0VfVBHGGsoA7Rn6DoAQn0ZBa7Ss6E-UP6WDZVncDgnVby1cVOyQ/exec?method=updateConfirmData&id=${id}&confirmStatus=${status}`;
        const res = await fetch(apiUrl);
        const text = await res.text();
        alert(text);
        liff.closeWindow();
      }
    }
    main();
  </script>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 60px; }
    .info { margin: 10px 0; font-size: 18px; }
    button {
      margin: 10px;
      padding: 10px 25px;
      font-size: 18px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    #yesBtn { background-color: #4CAF50; color: white; }
    #noBtn { background-color: #f44336; color: white; }
  </style>
</head>
<body>
  <h2>üìå ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h2>
  <div class="info">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°: <span id="activity"></span></div>
  <div class="info">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô: <span id="bookerName"></span></div>
  <div class="info">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤: <span id="datetime"></span></div>

  <button id="yesBtn">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
  <button id="noBtn">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
</body>
</html>
